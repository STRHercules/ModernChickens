--- a/net/minecraft/world/level/block/entity/AbstractFurnaceBlockEntity.java
+++ b/net/minecraft/world/level/block/entity/AbstractFurnaceBlockEntity.java
@@ -68,9 +_,14 @@
         public int get(int p_58431_) {
             switch (p_58431_) {
                 case 0:
+                    if (litTotalTime > Short.MAX_VALUE) {
+                        // Neo: preserve litTime / litDuration ratio on the client as data slots are synced as shorts.
+                        return net.minecraft.util.Mth.floor(((double) litTimeRemaining / litTotalTime) * Short.MAX_VALUE);
+                    }
+
                     return AbstractFurnaceBlockEntity.this.litTimeRemaining;
                 case 1:
-                    return AbstractFurnaceBlockEntity.this.litTotalTime;
+                    return Math.min(AbstractFurnaceBlockEntity.this.litTotalTime, Short.MAX_VALUE);
                 case 2:
                     return AbstractFurnaceBlockEntity.this.cookingTimer;
                 case 3:
@@ -104,12 +_,14 @@
     };
     private final Reference2IntOpenHashMap<ResourceKey<Recipe<?>>> recipesUsed = new Reference2IntOpenHashMap<>();
     private final RecipeManager.CachedCheck<SingleRecipeInput, ? extends AbstractCookingRecipe> quickCheck;
+    private final RecipeType<? extends AbstractCookingRecipe> recipeType;
 
     protected AbstractFurnaceBlockEntity(
         BlockEntityType<?> p_154991_, BlockPos p_154992_, BlockState p_154993_, RecipeType<? extends AbstractCookingRecipe> p_154994_
     ) {
         super(p_154991_, p_154992_, p_154993_);
         this.quickCheck = RecipeManager.createCheck((RecipeType<AbstractCookingRecipe>)p_154994_);
+        this.recipeType = p_154994_;
     }
 
     private boolean isLit() {
@@ -121,10 +_,10 @@
         super.loadAdditional(p_421736_);
         this.items = NonNullList.withSize(this.getContainerSize(), ItemStack.EMPTY);
         ContainerHelper.loadAllItems(p_421736_, this.items);
-        this.cookingTimer = p_421736_.getShortOr("cooking_time_spent", (short)0);
-        this.cookingTotalTime = p_421736_.getShortOr("cooking_total_time", (short)0);
-        this.litTimeRemaining = p_421736_.getShortOr("lit_time_remaining", (short)0);
-        this.litTotalTime = p_421736_.getShortOr("lit_total_time", (short)0);
+        this.cookingTimer = p_421736_.getIntOr("cooking_time_spent", (short)0);
+        this.cookingTotalTime = p_421736_.getIntOr("cooking_total_time", (short)0);
+        this.litTimeRemaining = p_421736_.getIntOr("lit_time_remaining", (short)0);
+        this.litTotalTime = p_421736_.getIntOr("lit_total_time", (short)0);
         this.recipesUsed.clear();
         this.recipesUsed.putAll(p_421736_.read("RecipesUsed", RECIPES_USED_CODEC).orElse(Map.of()));
     }
@@ -132,10 +_,10 @@
     @Override
     protected void saveAdditional(ValueOutput p_421785_) {
         super.saveAdditional(p_421785_);
-        p_421785_.putShort("cooking_time_spent", (short)this.cookingTimer);
-        p_421785_.putShort("cooking_total_time", (short)this.cookingTotalTime);
-        p_421785_.putShort("lit_time_remaining", (short)this.litTimeRemaining);
-        p_421785_.putShort("lit_total_time", (short)this.litTotalTime);
+        p_421785_.putInt("cooking_time_spent", this.cookingTimer);
+        p_421785_.putInt("cooking_total_time", this.cookingTotalTime);
+        p_421785_.putInt("lit_time_remaining", this.litTimeRemaining);
+        p_421785_.putInt("lit_total_time", this.litTotalTime);
         ContainerHelper.saveAllItems(p_421785_, this.items);
         p_421785_.store("RecipesUsed", RECIPES_USED_CODEC, this.recipesUsed);
     }
@@ -166,11 +_,15 @@
                 p_155017_.litTotalTime = p_155017_.litTimeRemaining;
                 if (p_155017_.isLit()) {
                     flag1 = true;
+                    var remainder = itemstack.getCraftingRemainder();
+                    if (!remainder.isEmpty())
+                        p_155017_.items.set(1, remainder);
+                    else
                     if (flag3) {
                         Item item = itemstack.getItem();
                         itemstack.shrink(1);
                         if (itemstack.isEmpty()) {
-                            p_155017_.items.set(1, item.getCraftingRemainder());
+                            p_155017_.items.set(1, item.getCraftingRemainder()); // Neo: Remainder is handled in the `if` check above.
                         }
                     }
                 }
@@ -223,9 +_,9 @@
                 } else if (!ItemStack.isSameItemSameComponents(itemstack1, itemstack)) {
                     return false;
                 } else {
-                    return itemstack1.getCount() < p_155008_ && itemstack1.getCount() < itemstack1.getMaxStackSize()
+                    return itemstack1.getCount() + itemstack.getCount() <= p_155008_ && itemstack1.getCount() + itemstack.getCount() <= itemstack1.getMaxStackSize() // Neo fix: make furnace respect stack sizes in furnace recipes
                         ? true
-                        : itemstack1.getCount() < itemstack.getMaxStackSize();
+                        : itemstack1.getCount() + itemstack.getCount() <= itemstack.getMaxStackSize(); // Neo fix: make furnace respect stack sizes in furnace recipes
                 }
             }
         } else {
@@ -247,7 +_,7 @@
             if (itemstack2.isEmpty()) {
                 p_267073_.set(2, itemstack1.copy());
             } else if (ItemStack.isSameItemSameComponents(itemstack2, itemstack1)) {
-                itemstack2.grow(1);
+                itemstack2.grow(itemstack1.getCount());
             }
 
             if (itemstack.is(Blocks.WET_SPONGE.asItem()) && !p_267073_.get(1).isEmpty() && p_267073_.get(1).is(Items.BUCKET)) {
@@ -262,7 +_,7 @@
     }
 
     protected int getBurnDuration(FuelValues p_363501_, ItemStack p_58343_) {
-        return p_363501_.burnDuration(p_58343_);
+        return p_58343_.getBurnTime(this.recipeType, p_363501_);
     }
 
     private static int getTotalCookTime(ServerLevel p_380169_, AbstractFurnaceBlockEntity p_222694_) {
@@ -306,17 +_,57 @@
 
     @Override
     public void setItem(int p_58333_, ItemStack p_58334_) {
+        setItem(p_58333_, p_58334_, false);
+    }
+
+    // Neo: Skip side-effects if insideTransaction is true so the caller can defer them until the transaction commits
+    @Override
+    public void setItem(int p_58333_, ItemStack p_58334_, boolean insideTransaction) {
         ItemStack itemstack = this.items.get(p_58333_);
         boolean flag = !p_58334_.isEmpty() && ItemStack.isSameItemSameComponents(itemstack, p_58334_);
         this.items.set(p_58333_, p_58334_);
         p_58334_.limitSize(this.getMaxStackSize(p_58334_));
-        if (p_58333_ == 0 && !flag && this.level instanceof ServerLevel serverlevel) {
+        if (p_58333_ == 0 && !flag && this.level instanceof ServerLevel serverlevel && !insideTransaction) {
             this.cookingTotalTime = getTotalCookTime(serverlevel, this);
             this.cookingTimer = 0;
             this.setChanged();
         }
     }
 
+    // Neo: Reset cooking time when the input changes inside a transaction
+    private boolean needsCookingReset = false;
+    private final net.neoforged.neoforge.transfer.transaction.SnapshotJournal<Boolean> cookingResetJournal = new net.neoforged.neoforge.transfer.transaction.SnapshotJournal<Boolean>() {
+        @Override
+        protected Boolean createSnapshot() {
+            return needsCookingReset;
+        }
+        @Override
+        protected void revertToSnapshot(Boolean snapshot) {
+            needsCookingReset = snapshot;
+        }
+        @Override
+        protected void onRootCommit(Boolean originalState) {
+            if (needsCookingReset) {
+                if (level instanceof ServerLevel serverLevel) {
+                    cookingTotalTime = getTotalCookTime(serverLevel, AbstractFurnaceBlockEntity.this);
+                    cookingTimer = 0;
+                }
+                needsCookingReset = false;
+            }
+        }
+    };
+
+    @Override
+    public void onTransfer(int slot, int amountChange, net.neoforged.neoforge.transfer.transaction.TransactionContext transaction) {
+        if (slot == 0) {
+            int currentAmount = getItem(slot).getCount();
+            if (currentAmount == 0 || currentAmount == amountChange) {
+                cookingResetJournal.updateSnapshots(transaction);
+                needsCookingReset = true;
+            }
+        }
+    }
+
     @Override
     public boolean canPlaceItem(int p_58389_, ItemStack p_58390_) {
         if (p_58389_ == 2) {
@@ -325,7 +_,7 @@
             return true;
         } else {
             ItemStack itemstack = this.items.get(1);
-            return this.level.fuelValues().isFuel(p_58390_) || p_58390_.is(Items.BUCKET) && !itemstack.is(Items.BUCKET);
+            return p_58390_.getBurnTime(this.recipeType, this.level.fuelValues()) > 0 || p_58390_.is(Items.BUCKET) && !itemstack.is(Items.BUCKET);
         }
     }
 
