--- a/net/minecraft/world/entity/npc/VillagerTrades.java
+++ b/net/minecraft/world/entity/npc/VillagerTrades.java
@@ -1390,6 +_,7 @@
         private final int villagerXp;
 
         public EmeraldsForVillagerTypeItem(int p_35669_, int p_35670_, int p_35671_, Map<ResourceKey<VillagerType>, Item> p_35672_) {
+            if (false) // Neo: disable this check so that mods can add custom villager types
             BuiltInRegistries.VILLAGER_TYPE.registryKeySet().stream().filter(p_397212_ -> !p_35672_.containsKey(p_397212_)).findAny().ifPresent(p_396860_ -> {
                 throw new IllegalStateException("Missing trade for villager type: " + p_396860_);
             });
@@ -1407,7 +_,9 @@
                 if (resourcekey == null) {
                     return null;
                 } else {
-                    ItemCost itemcost = new ItemCost(this.trades.get(resourcekey), this.cost);
+                    Item item = this.trades.get(resourcekey);
+                    if (item == null) return null;
+                    ItemCost itemcost = new ItemCost(item, this.cost);
                     return new MerchantOffer(itemcost, new ItemStack(Items.EMERALD), this.maxUses, this.villagerXp, 0.05F);
                 }
             } else {
